<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Riyanshi Bohra">

<title>Homework 2- Imputing like a Data Scientist</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw-02-04_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw-02-04_files/libs/quarto-html/quarto.js"></script>
<script src="hw-02-04_files/libs/quarto-html/popper.min.js"></script>
<script src="hw-02-04_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw-02-04_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw-02-04_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw-02-04_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw-02-04_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw-02-04_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw-02-04_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 2- Imputing like a Data Scientist</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Riyanshi Bohra </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="homework-2-" class="level1">
<h1>Homework 2-</h1>
</section>
<section id="imputing-like-a-data-scientist" class="level1">
<h1>Imputing like a Data Scientist</h1>
</section>
<section id="setting-up" class="level1">
<h1>Setting up</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Installing and loading required packages</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(colorblindr, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               cluster, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               dlookr, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               formattable, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               ggfortify, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               ggpubr, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               here, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               kableExtra, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               knitr, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>               missRanger,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               plotly, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>               rattle, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>               rpart, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>               tidyverse, </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>               visdat) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'colorblindr' is not available for this version of R

A version of this package for your version of R might be available elsewhere,
see the ideas at
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in p_install(package, character.only = TRUE, ...):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'colorblindr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pacman::p_load(colorblindr, cluster, dlookr, formattable, ggfortify, : Failed to install/load:
colorblindr</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting global ggplot() theme</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Theme pub_clean() from the ggpubr package</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_pubclean</span>(<span class="at">base_size =</span> <span class="dv">16</span>)) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="co"># Remove axes ticks</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>()) <span class="co"># Remove legend key</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="loading-the-tornados-dataset-and-adding-a-categorical-group" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-tornados-dataset-and-adding-a-categorical-group">Loading the Tornados dataset and adding a categorical group</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the 'tornados.csv' dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/riyanshibohra/Desktop/tornados.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Add a categorical group</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year_group =</span> <span class="fu">ifelse</span>(yr <span class="sc">&gt;=</span> <span class="dv">1950</span> <span class="sc">&amp;</span> yr <span class="sc">&lt;=</span> <span class="dv">1975</span>, <span class="st">"1950-1975"</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(yr <span class="sc">&gt;</span> <span class="dv">1975</span> <span class="sc">&amp;</span> yr <span class="sc">&lt;=</span> <span class="dv">2000</span>, <span class="st">"1976-2000"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"2001-2022"</span>)),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year_group =</span> <span class="fu">fct_rev</span>(Year_group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="diagnosing-the-data" class="level1">
<h1>Diagnosing the data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the dataset to get an overview</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
om
</th>
<th style="text-align:right;">
yr
</th>
<th style="text-align:right;">
mo
</th>
<th style="text-align:right;">
dy
</th>
<th style="text-align:right;">
date
</th>
<th style="text-align:right;">
time
</th>
<th style="text-align:right;">
tz
</th>
<th style="text-align:right;">
datetime_utc
</th>
<th style="text-align:right;">
st
</th>
<th style="text-align:right;">
stf
</th>
<th style="text-align:right;">
mag
</th>
<th style="text-align:right;">
inj
</th>
<th style="text-align:right;">
fat
</th>
<th style="text-align:right;">
loss
</th>
<th style="text-align:right;">
slat
</th>
<th style="text-align:right;">
slon
</th>
<th style="text-align:right;">
elat
</th>
<th style="text-align:right;">
elon
</th>
<th style="text-align:right;">
len
</th>
<th style="text-align:right;">
wid
</th>
<th style="text-align:right;">
ns
</th>
<th style="text-align:right;">
sn
</th>
<th style="text-align:right;">
f1
</th>
<th style="text-align:right;">
f2
</th>
<th style="text-align:right;">
f3
</th>
<th style="text-align:right;">
f4
</th>
<th style="text-align:right;">
fc
</th>
<th style="text-align:right;">
Year_group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
192
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1950-10-01
</td>
<td style="text-align:right;">
21:00:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-10-02T03:00:00Z
</td>
<td style="text-align:right;">
OK
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+04
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
-103
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
-102
</td>
<td style="text-align:right;">
15.8
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1950-10-09
</td>
<td style="text-align:right;">
02:15:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-10-09T08:15:00Z
</td>
<td style="text-align:right;">
NC
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
-79
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
880
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
195
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
1950-11-20
</td>
<td style="text-align:right;">
02:20:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-11-20T08:20:00Z
</td>
<td style="text-align:right;">
KY
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
-87
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
1950-11-20
</td>
<td style="text-align:right;">
04:00:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-11-20T10:00:00Z
</td>
<td style="text-align:right;">
KY
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
-84
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
209
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
197
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
1950-11-20
</td>
<td style="text-align:right;">
07:30:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-11-20T13:30:00Z
</td>
<td style="text-align:right;">
MS
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+04
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
-89
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
194
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1950-11-04
</td>
<td style="text-align:right;">
17:00:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-11-04T23:00:00Z
</td>
<td style="text-align:right;">
PA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
-76
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
-76
</td>
<td style="text-align:right;">
15.9
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
</tbody>

</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore and display the general properties and structure of the dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diagnose</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
variables
</th>
<th style="text-align:right;">
types
</th>
<th style="text-align:right;">
missing_count
</th>
<th style="text-align:right;">
missing_percent
</th>
<th style="text-align:right;">
unique_count
</th>
<th style="text-align:right;">
unique_rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
om
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
16008
</td>
<td style="text-align:right;">
2.3e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
yr
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
1.1e-03
</td>
</tr>
<tr>
<td style="text-align:right;">
mo
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.7e-04
</td>
</tr>
<tr>
<td style="text-align:right;">
dy
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
4.5e-04
</td>
</tr>
<tr>
<td style="text-align:right;">
date
</td>
<td style="text-align:right;">
character
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
12458
</td>
<td style="text-align:right;">
1.8e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
time
</td>
<td style="text-align:right;">
character
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1438
</td>
<td style="text-align:right;">
2.1e-02
</td>
</tr>
<tr>
<td style="text-align:right;">
tz
</td>
<td style="text-align:right;">
character
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.4e-05
</td>
</tr>
<tr>
<td style="text-align:right;">
datetime_utc
</td>
<td style="text-align:right;">
character
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
64866
</td>
<td style="text-align:right;">
9.4e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
st
</td>
<td style="text-align:right;">
character
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
7.7e-04
</td>
</tr>
<tr>
<td style="text-align:right;">
stf
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
7.7e-04
</td>
</tr>
<tr>
<td style="text-align:right;">
mag
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
756
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.0e-04
</td>
</tr>
<tr>
<td style="text-align:right;">
inj
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
209
</td>
<td style="text-align:right;">
3.0e-03
</td>
</tr>
<tr>
<td style="text-align:right;">
fat
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
7.3e-04
</td>
</tr>
<tr>
<td style="text-align:right;">
loss
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
27170
</td>
<td style="text-align:right;">
39.6
</td>
<td style="text-align:right;">
771
</td>
<td style="text-align:right;">
1.1e-02
</td>
</tr>
<tr>
<td style="text-align:right;">
slat
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
15084
</td>
<td style="text-align:right;">
2.2e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
slon
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
16930
</td>
<td style="text-align:right;">
2.5e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
elat
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
15978
</td>
<td style="text-align:right;">
2.3e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
elon
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
17538
</td>
<td style="text-align:right;">
2.6e-01
</td>
</tr>
<tr>
<td style="text-align:right;">
len
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
2477
</td>
<td style="text-align:right;">
3.6e-02
</td>
</tr>
<tr>
<td style="text-align:right;">
wid
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
411
</td>
<td style="text-align:right;">
6.0e-03
</td>
</tr>
<tr>
<td style="text-align:right;">
ns
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.4e-05
</td>
</tr>
<tr>
<td style="text-align:right;">
sn
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.9e-05
</td>
</tr>
<tr>
<td style="text-align:right;">
f1
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
285
</td>
<td style="text-align:right;">
4.1e-03
</td>
</tr>
<tr>
<td style="text-align:right;">
f2
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
226
</td>
<td style="text-align:right;">
3.3e-03
</td>
</tr>
<tr>
<td style="text-align:right;">
f3
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:right;">
2.2e-03
</td>
</tr>
<tr>
<td style="text-align:right;">
f4
</td>
<td style="text-align:right;">
integer
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
1.6e-03
</td>
</tr>
<tr>
<td style="text-align:right;">
fc
</td>
<td style="text-align:right;">
logical
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.9e-05
</td>
</tr>
<tr>
<td style="text-align:right;">
Year_group
</td>
<td style="text-align:right;">
factor
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4.4e-05
</td>
</tr>
</tbody>

</table>
</div>
</div>
<section id="dealing-with-outliers" class="level2">
<h2 class="anchored" data-anchor-id="dealing-with-outliers">Dealing with Outliers</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table showing outliers</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diagnose_outlier</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(outliers_ratio <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> outliers_mean <span class="sc">/</span> with_mean) <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rate)) <span class="sc">|&gt;</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>outliers_cnt) <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
variables
</th>
<th style="text-align:right;">
outliers_ratio
</th>
<th style="text-align:right;">
outliers_mean
</th>
<th style="text-align:right;">
with_mean
</th>
<th style="text-align:right;">
without_mean
</th>
<th style="text-align:right;">
rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
f4
</td>
<td style="text-align:right;">
0.470
</td>
<td style="text-align:right;">
1.1e+02
</td>
<td style="text-align:right;">
5.1e-01
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
212.67
</td>
</tr>
<tr>
<td style="text-align:right;">
f3
</td>
<td style="text-align:right;">
1.604
</td>
<td style="text-align:right;">
1.1e+02
</td>
<td style="text-align:right;">
1.7e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
62.33
</td>
</tr>
<tr>
<td style="text-align:right;">
fat
</td>
<td style="text-align:right;">
2.290
</td>
<td style="text-align:right;">
3.9e+00
</td>
<td style="text-align:right;">
8.9e-02
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
43.67
</td>
</tr>
<tr>
<td style="text-align:right;">
f2
</td>
<td style="text-align:right;">
8.186
</td>
<td style="text-align:right;">
1.1e+02
</td>
<td style="text-align:right;">
8.6e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
12.22
</td>
</tr>
<tr>
<td style="text-align:right;">
loss
</td>
<td style="text-align:right;">
5.012
</td>
<td style="text-align:right;">
2.3e+07
</td>
<td style="text-align:right;">
2.0e+06
</td>
<td style="text-align:right;">
1.4e+05
</td>
<td style="text-align:right;">
11.27
</td>
</tr>
<tr>
<td style="text-align:right;">
inj
</td>
<td style="text-align:right;">
11.294
</td>
<td style="text-align:right;">
1.3e+01
</td>
<td style="text-align:right;">
1.4e+00
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
8.85
</td>
</tr>
<tr>
<td style="text-align:right;">
len
</td>
<td style="text-align:right;">
12.121
</td>
<td style="text-align:right;">
1.9e+01
</td>
<td style="text-align:right;">
3.5e+00
</td>
<td style="text-align:right;">
1.4e+00
</td>
<td style="text-align:right;">
5.40
</td>
</tr>
<tr>
<td style="text-align:right;">
wid
</td>
<td style="text-align:right;">
10.835
</td>
<td style="text-align:right;">
5.5e+02
</td>
<td style="text-align:right;">
1.1e+02
</td>
<td style="text-align:right;">
5.3e+01
</td>
<td style="text-align:right;">
5.14
</td>
</tr>
<tr>
<td style="text-align:right;">
om
</td>
<td style="text-align:right;">
20.663
</td>
<td style="text-align:right;">
5.5e+05
</td>
<td style="text-align:right;">
1.1e+05
</td>
<td style="text-align:right;">
5.1e+02
</td>
<td style="text-align:right;">
4.82
</td>
</tr>
<tr>
<td style="text-align:right;">
mag
</td>
<td style="text-align:right;">
4.658
</td>
<td style="text-align:right;">
3.2e+00
</td>
<td style="text-align:right;">
7.8e-01
</td>
<td style="text-align:right;">
6.6e-01
</td>
<td style="text-align:right;">
4.13
</td>
</tr>
<tr>
<td style="text-align:right;">
f1
</td>
<td style="text-align:right;">
5.851
</td>
<td style="text-align:right;">
4.0e+02
</td>
<td style="text-align:right;">
1.0e+02
</td>
<td style="text-align:right;">
8.6e+01
</td>
<td style="text-align:right;">
3.84
</td>
</tr>
<tr>
<td style="text-align:right;">
mo
</td>
<td style="text-align:right;">
2.731
</td>
<td style="text-align:right;">
1.2e+01
</td>
<td style="text-align:right;">
6.0e+00
</td>
<td style="text-align:right;">
5.8e+00
</td>
<td style="text-align:right;">
2.01
</td>
</tr>
<tr>
<td style="text-align:right;">
ns
</td>
<td style="text-align:right;">
0.859
</td>
<td style="text-align:right;">
2.0e+00
</td>
<td style="text-align:right;">
1.0e+00
</td>
<td style="text-align:right;">
1.0e+00
</td>
<td style="text-align:right;">
2.00
</td>
</tr>
<tr>
<td style="text-align:right;">
slon
</td>
<td style="text-align:right;">
1.354
</td>
<td style="text-align:right;">
-1.2e+02
</td>
<td style="text-align:right;">
-9.3e+01
</td>
<td style="text-align:right;">
-9.2e+01
</td>
<td style="text-align:right;">
1.26
</td>
</tr>
<tr>
<td style="text-align:right;">
slat
</td>
<td style="text-align:right;">
0.098
</td>
<td style="text-align:right;">
2.2e+01
</td>
<td style="text-align:right;">
3.7e+01
</td>
<td style="text-align:right;">
3.7e+01
</td>
<td style="text-align:right;">
0.59
</td>
</tr>
<tr>
<td style="text-align:right;">
sn
</td>
<td style="text-align:right;">
0.859
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
9.9e-01
</td>
<td style="text-align:right;">
1.0e+00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>

</table>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#An initial diagnosis multiple rows with potential outliers, which might require further analysis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data with and without outliers</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">find_outliers</span>(dataset)) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">plot_outlier</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="dealing-with-missing-valuesnas" class="level2">
<h2 class="anchored" data-anchor-id="dealing-with-missing-valuesnas">Dealing with Missing Values(NAs)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly generate NAs for 30</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>na.dataset <span class="ot">&lt;-</span> dataset <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generateNA</span>(<span class="at">p =</span> <span class="fl">0.3</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># First six rows</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>na.dataset <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
om
</th>
<th style="text-align:right;">
yr
</th>
<th style="text-align:right;">
mo
</th>
<th style="text-align:right;">
dy
</th>
<th style="text-align:right;">
date
</th>
<th style="text-align:right;">
time
</th>
<th style="text-align:right;">
tz
</th>
<th style="text-align:right;">
datetime_utc
</th>
<th style="text-align:right;">
st
</th>
<th style="text-align:right;">
stf
</th>
<th style="text-align:right;">
mag
</th>
<th style="text-align:right;">
inj
</th>
<th style="text-align:right;">
fat
</th>
<th style="text-align:right;">
loss
</th>
<th style="text-align:right;">
slat
</th>
<th style="text-align:right;">
slon
</th>
<th style="text-align:right;">
elat
</th>
<th style="text-align:right;">
elon
</th>
<th style="text-align:right;">
len
</th>
<th style="text-align:right;">
wid
</th>
<th style="text-align:right;">
ns
</th>
<th style="text-align:right;">
sn
</th>
<th style="text-align:right;">
f1
</th>
<th style="text-align:right;">
f2
</th>
<th style="text-align:right;">
f3
</th>
<th style="text-align:right;">
f4
</th>
<th style="text-align:right;">
fc
</th>
<th style="text-align:right;">
Year_group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
192
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21:00:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-10-02T03:00:00Z
</td>
<td style="text-align:right;">
OK
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+04
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
-103
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
-102
</td>
<td style="text-align:right;">
15.8
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1950-10-09
</td>
<td style="text-align:right;">
02:15:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NC
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
195
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
02:20:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-11-20T08:20:00Z
</td>
<td style="text-align:right;">
KY
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
1950-11-20
</td>
<td style="text-align:right;">
04:00:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
-84
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
197
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
1950-11-20
</td>
<td style="text-align:right;">
07:30:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
1950-11-20T13:30:00Z
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
-89
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
<tr>
<td style="text-align:right;">
194
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
17:00:00
</td>
<td style="text-align:right;">
America/Chicago
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5e+05
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
FALSE
</td>
<td style="text-align:right;">
1950-1975
</td>
</tr>
</tbody>

</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the NA table</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>na.dataset <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_na_pareto</span>(<span class="at">only_na =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
variable
</th>
<th style="text-align:right;">
frequencies
</th>
<th style="text-align:right;">
ratio
</th>
<th style="text-align:right;">
grade
</th>
<th style="text-align:right;">
cumulative
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
loss
</td>
<td style="text-align:right;">
39545
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
Remove
</td>
<td style="text-align:right;">
6.6
</td>
</tr>
<tr>
<td style="text-align:right;">
mag
</td>
<td style="text-align:right;">
21147
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
10.2
</td>
</tr>
<tr>
<td style="text-align:right;">
Year_group
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
13.6
</td>
</tr>
<tr>
<td style="text-align:right;">
date
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
17.1
</td>
</tr>
<tr>
<td style="text-align:right;">
datetime_utc
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
20.5
</td>
</tr>
<tr>
<td style="text-align:right;">
dy
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
24.0
</td>
</tr>
<tr>
<td style="text-align:right;">
elat
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
27.4
</td>
</tr>
<tr>
<td style="text-align:right;">
elon
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
30.9
</td>
</tr>
<tr>
<td style="text-align:right;">
f1
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
34.4
</td>
</tr>
<tr>
<td style="text-align:right;">
f2
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
37.8
</td>
</tr>
<tr>
<td style="text-align:right;">
f3
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
41.3
</td>
</tr>
<tr>
<td style="text-align:right;">
f4
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
44.7
</td>
</tr>
<tr>
<td style="text-align:right;">
fat
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
48.2
</td>
</tr>
<tr>
<td style="text-align:right;">
fc
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
51.6
</td>
</tr>
<tr>
<td style="text-align:right;">
inj
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
55.1
</td>
</tr>
<tr>
<td style="text-align:right;">
len
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
58.5
</td>
</tr>
<tr>
<td style="text-align:right;">
mo
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
62.0
</td>
</tr>
<tr>
<td style="text-align:right;">
ns
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
65.5
</td>
</tr>
<tr>
<td style="text-align:right;">
om
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
68.9
</td>
</tr>
<tr>
<td style="text-align:right;">
slat
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
72.4
</td>
</tr>
<tr>
<td style="text-align:right;">
slon
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
75.8
</td>
</tr>
<tr>
<td style="text-align:right;">
sn
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
79.3
</td>
</tr>
<tr>
<td style="text-align:right;">
st
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
82.7
</td>
</tr>
<tr>
<td style="text-align:right;">
stf
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
86.2
</td>
</tr>
<tr>
<td style="text-align:right;">
time
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
89.6
</td>
</tr>
<tr>
<td style="text-align:right;">
tz
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
93.1
</td>
</tr>
<tr>
<td style="text-align:right;">
wid
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
96.5
</td>
</tr>
<tr>
<td style="text-align:right;">
yr
</td>
<td style="text-align:right;">
20608
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
</tbody>

</table>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># The dataset contains the most missing values in the mag, loss, and Year_group columns. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the data table</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>na.dataset <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_na_pareto</span>(<span class="at">only_na =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="advanced-exploration-of-missing-valuesnas" class="level2">
<h2 class="anchored" data-anchor-id="advanced-exploration-of-missing-valuesnas">Advanced Exploration of Missing Values(NAs)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the intersect of columns with the most missing values- Year_group,loss,mag</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>na.dataset <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year_group, loss, mag) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_na_intersect</span>(<span class="at">only_na =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="imputing-outliers-and-nas" class="level1">
<h1>Imputing Outliers and NAs</h1>
<section id="outliers" class="level2">
<h2 class="anchored" data-anchor-id="outliers">Outliers</h2>
<section id="classification-of-outliers" class="level3">
<h3 class="anchored" data-anchor-id="classification-of-outliers">Classification of Outliers</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the Okabe-Ito colors</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>OkabeItoColors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use with the provided ggplot2 code</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>dataset <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wid, <span class="at">y =</span> Year_group, <span class="at">fill =</span> Year_group)) <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>, <span class="at">outlier.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> OkabeItoColors) <span class="sc">+</span>  <span class="co"># Applying the Okabe-Ito color palette</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Width in Yards"</span>) <span class="sc">+</span>  </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Year group"</span>) <span class="sc">+</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Removing the legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#It's evident through the boxplot that there are multiple outlier points in the 'wid' column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mean-imputation" class="level3">
<h3 class="anchored" data-anchor-id="mean-imputation">Mean Imputation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mean_out_imp_width<span class="ot">&lt;-</span> dataset <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wid) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wid <span class="sc">&lt;</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(wid, <span class="at">method =</span> <span class="st">"mean"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>mean_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with mean

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "67955"  "67955"   
na                  "0"      "0"       
mean                "93"     "57"      
sd                  "142"    " 49"     
se_mean             "0.54"   "0.19"    
IQR                 "80"     "73"      
skewness            "3.2"    "1.3"     
kurtosis            "11.9"   " 1.2"    
p00                 "0"      "0"       
p01                 "10"     "10"      
p05                 "10"     "10"      
p10                 "10"     "10"      
p20                 "10"     "10"      
p25                 "20"     "20"      
p30                 "20"     "20"      
p40                 "30"     "30"      
p50                 "50"     "50"      
p60                 "50"     "50"      
p70                 "80"     "80"      
p75                 "100"    " 93"     
p80                 "100"    " 93"     
p90                 "220"    "100"     
p95                 "400"    "167"     
p99                 "800"    "200"     
p100                "990"    "220"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the mean imputation</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mean_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean imputation for the wid column has effectively neutralized extreme outliers by replacing them with the average width</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="median-imputation" class="level3">
<h3 class="anchored" data-anchor-id="median-imputation">Median Imputation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>med_out_imp_width <span class="ot">&lt;-</span> dataset <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wid) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wid <span class="sc">&lt;</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(wid, <span class="at">method =</span> <span class="st">"median"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>med_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with median

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "67955"  "67955"   
na                  "0"      "0"       
mean                "93"     "53"      
sd                  "142"    " 48"     
se_mean             "0.54"   "0.18"    
IQR                 "80"     "50"      
skewness            "3.2"    "1.6"     
kurtosis            "11.9"   " 2.2"    
p00                 "0"      "0"       
p01                 "10"     "10"      
p05                 "10"     "10"      
p10                 "10"     "10"      
p20                 "10"     "10"      
p25                 "20"     "20"      
p30                 "20"     "20"      
p40                 "30"     "30"      
p50                 "50"     "50"      
p60                 "50"     "50"      
p70                 "80"     "50"      
p75                 "100"    " 70"     
p80                 "100"    " 80"     
p90                 "220"    "100"     
p95                 "400"    "167"     
p99                 "800"    "200"     
p100                "990"    "220"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of the median imputation</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>med_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Median imputation for the wid column has addressed the outliers by substituting them with the median width. This approach is more robust to extreme values than mean imputation, but it also increases the frequency of the median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mode-imputation" class="level3">
<h3 class="anchored" data-anchor-id="mode-imputation">Mode Imputation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mode_out_imp_width <span class="ot">&lt;-</span> dataset <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wid) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wid <span class="sc">&lt;</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(wid, <span class="at">method =</span> <span class="st">"mode"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>mode_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with mode

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "67955"  "67955"   
na                  "0"      "0"       
mean                "93"     "49"      
sd                  "142"    " 50"     
se_mean             "0.54"   "0.19"    
IQR                 "80"     "60"      
skewness            "3.2"    "1.6"     
kurtosis            "11.9"   " 2.1"    
p00                 "0"      "0"       
p01                 "10"     "10"      
p05                 "10"     "10"      
p10                 "10"     "10"      
p20                 "10"     "10"      
p25                 "20"     "10"      
p30                 "20"     "10"      
p40                 "30"     "20"      
p50                 "50"     "30"      
p60                 "50"     "50"      
p70                 "80"     "50"      
p75                 "100"    " 70"     
p80                 "100"    " 80"     
p90                 "220"    "100"     
p95                 "400"    "167"     
p99                 "800"    "200"     
p100                "990"    "220"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of the mode imputation</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mode_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mode imputation for the wid column has managed the outliers by replacing them with the most common width in the dataset. While this method acknowledges the most typical occurrence, it can introduce bias.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="winsorizing--capping-imputation" class="level3">
<h3 class="anchored" data-anchor-id="winsorizing--capping-imputation">Winsorizing- Capping Imputation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cap_out_imp_width <span class="ot">&lt;-</span> dataset <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wid) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wid <span class="sc">&lt;</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(wid, <span class="at">method =</span> <span class="st">"capping"</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>cap_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with capping

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "67955"  "67955"   
na                  "0"      "0"       
mean                "93"     "88"      
sd                  "142"    "114"     
se_mean             "0.54"   "0.44"    
IQR                 "80"     "80"      
skewness            "3.2"    "2.0"     
kurtosis            "11.9"   " 2.7"    
p00                 "0"      "0"       
p01                 "10"     "10"      
p05                 "10"     "10"      
p10                 "10"     "10"      
p20                 "10"     "10"      
p25                 "20"     "20"      
p30                 "20"     "20"      
p40                 "30"     "30"      
p50                 "50"     "50"      
p60                 "50"     "50"      
p70                 "80"     "80"      
p75                 "100"    "100"     
p80                 "100"    "100"     
p90                 "220"    "220"     
p95                 "400"    "400"     
p99                 "800"    "400"     
p100                "990"    "400"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of the capping imputation</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>cap_out_imp_width <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-04_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Winsorizing the wid column has managed outliers by arranging them to specified percentiles, thereby preserving the distribution's general shape</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="missing-values" class="level2">
<h2 class="anchored" data-anchor-id="missing-values">Missing Values</h2>
<section id="k-nearest-neighborknn-imputation" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighborknn-imputation">K-Nearest Neighbor(KNN) Imputation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Unable to run code block as discussed in class</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#It appears that the KNN imputation requires a huge amount of memory due to the size of the dataset, leading to a memory error.</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#autoplot(clara(dataset[-5],3)) </span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_OkabeIto()</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#knn_na_imp_width &lt;- na.dataset |&gt;</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#imputate_na(wid, method = "knn")</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">#knn_na_imp_width |&gt;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recursive-partitioning-and-regression-trees-rpart" class="level3">
<h3 class="anchored" data-anchor-id="recursive-partitioning-and-regression-trees-rpart">Recursive Partitioning and Regression Trees (rpart)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Unable to run code block as discussed in class</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#It is encountering issues, particularly due to NaN values present in the dataset.</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#rpart_na_imp_width &lt;- na.dataset |&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#imputate_na(wid, method = "rpart")</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot showing the results of our imputation</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#rpart_na_imp_width |&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multivariate-imputation-by-chained-equations-mice" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-imputation-by-chained-equations-mice">Multivariate Imputation by Chained Equations (MICE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This block of code took more time than expected to execute(while rendering) so commenting out</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#mice_na_imp_width &lt;- na.dataset |&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#imputate_na(wid, method = "mice", seed = 123)</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#mice_na_imp_insulin |&gt;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot()</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">#The Multivariate Imputation by Chained Equations (MICE) approach effectively imputes missing values in the wid column, preserving the original distribution's characteristics. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>